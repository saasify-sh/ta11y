<p align="center">
  <a href="https://ta11y.saasify.sh" title="ta11y">
    <img src="TODO" alt="ta11y Logo" width="256" />
  </a>
</p>

# @ta11y/core

> Core library for running web accessibility audits with ta11y.

[![NPM](https://img.shields.io/npm/v/@ta11y/core.svg)](https://www.npmjs.com/package/@ta11y/core) [![Build Status](https://travis-ci.com/saasify-sh/ta11y.svg?branch=master)](https://travis-ci.com/saasify-sh/ta11y) [![JavaScript Style Guide](https://img.shields.io/badge/code_style-standard-brightgreen.svg)](https://standardjs.com)

## Install

```bash
npm install --save @ta11y/core
```

## Usage

```js
const { Ta11y } = require('@ta11y/core')

const ta11y = new Ta11y()

ta11y.audit('https://en.wikipedia.org')
  .then((results) => {
    console.log(results)
  })
```

Alternatively, you can tell ta11y to **crawl** starting from the URL.

```js
ta11y.audit('https://en.wikipedia.org', {
  crawl: true,
  maxDepth: 1,
  maxVisit: 64
})
```

If you want to crawl non-public pages, pass an instance of [Puppeteer](https://pptr.dev). This is useful for testing in development or behind corporate firewalls.

```js
const puppeteer = require('puppeteer')

const browser = await puppeteer.launch(launchOptions)

ta11y.audit('http://localhost:3000', {
  browser,
  crawl: true,
  maxDepth: 0
})
```

You can also pass HTML directly to audit (whole pages or fragments).

```js
ta11y.audit('<!doctype><html><body><h1>I ❤ accessibility</h1></body></html>')
```

Note that you will need to pass an `apiKey` to the `Ta11y` constructor once you want to disable rate-limiting.

Visit [ta11y](https://ta11y.saasify.sh) to sign up for an API key.

```js
const ta11y = new Ta11y({
  apiKey: '<your-api-key>'
})
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### [Ta11y](https://git@github.com/:saasify-sh/ta11y/blob/dff7dd3678e50229bc73c20098a75e5f86b29222/packages/ta11y-core/lib/index.js#L18-L121)

Class to run web accessibility audits via the [ta11y API](https://ta11y.saasify.sh).

Type: `function (opts)`

-   `opts` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)?** Config options.
    -   `opts.apiKey` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)?** Optional ta11y API key which disables rate limits.
    -   `opts.apiBaseUrl` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Optional custom Ta11y deployment which is useful for on-premise scenarios. (optional, default `'https://ssfy.sh/dev/ta11y'`)

### [audit](https://git@github.com/:saasify-sh/ta11y/blob/dff7dd3678e50229bc73c20098a75e5f86b29222/packages/ta11y-core/lib/index.js#L61-L69)

Runs an accessibility audit against the given URL or raw HTML, optionally crawling the
site to discover additional pages and auditing those too.

To audit local or private websites, pass an instance of Puppeteer as `opts.browser`.

The default behavior is to perform content extraction and auditing remotely. This works
best for auditing publicly accessible websites.

Type: `function (urlOrHtml, opts): Promise`

-   `urlOrHtml` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** URL or raw HTML to process.
-   `opts` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Config options.
    -   `opts.browser` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)?** Optional [Puppeteer](https://pptr.dev) browser instance to use for auditing websites that aren't publicly reachable.
    -   `opts.crawl` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** Whether or not to crawl secondary pages. (optional, default `false`)
    -   `opts.maxDepth` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Maximum crawl depth while crawling. (optional, default `16`)
    -   `opts.maxVisit` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Maximum number of pages to visit while crawling.
    -   `opts.sameOrigin` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** Whether or not to only consider crawling links with the same origin as the root URL. (optional, default `true`)
    -   `opts.blacklist` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>?** Optional blacklist of URL [glob patterns](https://github.com/micromatch/micromatch) to ignore.
    -   `opts.whitelist` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>?** Optional whitelist of URL [glob patterns](https://github.com/micromatch/micromatch) to only include.
    -   `opts.gotoOptions` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)?** Customize the `Page.goto` navigation options.
    -   `opts.viewport` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)?** Set the browser window's viewport dimensions and/or resolution.
    -   `opts.userAgent` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)?** Set the browser's [user-agent](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent).
    -   `opts.emulateDevice` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)?** Make it look like the screenshot was taken on the specified device.-   Use the `name` property from one of the built-in [devices](https://github.com/GoogleChrome/puppeteer/blob/master/lib/DeviceDescriptors.js).
        -   Overrides `viewport` and `userAgent`.

### [auditExtractResults](https://git@github.com/:saasify-sh/ta11y/blob/dff7dd3678e50229bc73c20098a75e5f86b29222/packages/ta11y-core/lib/index.js#L80-L90)

Runs an accessibility audit against previously collected extraction results from
`@ta11y/extract`.

Type: `function (extractResults): Promise`

-   `extractResults` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Extraction results conforming to the output format
    from `@ta11y/extract`.

## License

MIT © [Saasify](https://saasify.sh)
